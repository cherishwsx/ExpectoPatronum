---
description: Easy
---

# 176. Second Highest Salary

See original page [here](https://leetcode.com/problems/second-highest-salary/).

## Problem

Write a SQL query to get the second highest salary from the `Employee` table.

```text
+----+--------+
| Id | Salary |
+----+--------+
| 1  | 100    |
| 2  | 200    |
| 3  | 300    |
+----+--------+
```

For example, given the above Employee table, the query should return `200` as the second highest salary. If there is no second highest salary, then the query should return `null`.

```text
+---------------------+
| SecondHighestSalary |
+---------------------+
| 200                 |
+---------------------+
```

## Solution

### New Points

1. ifnull\(expression, value\) Mysql中适用，如果expression为null，那么就取value的值。详情看[这里](https://www.w3schools.com/sql/sql_isnull.asp)。
2. limit m offset n Mysql中适用，意思是给出把前面n行去掉不算从第n+1行开始数m行的record。适用于找N大的值。
3. dense\_rank\(\) over\(\) 也可以但是leetcode mysql版本过低。

### Detail

1. 因为可能有重复的工资，所以排序要对distinct的工资来排，才能对应offset 1 limit 1

```sql
select (
    ifnull(
        (select distinct Salary from Employee
        order by Salary DESC
        limit 1 offset 1)
    , null)
) AS SecondHighestSalary
```

Not sure why below doesn't work.

```sql
with cte as (
    select Salary, dense_rank() over(order by Salary desc) as rnk
    from Employee
)
select case when Salary != '' then Salary else null end as SecondHighestSalary 
from cte where rnk = 2;
```

